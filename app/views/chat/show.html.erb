<div class="flex flex-col h-[calc(100svh-4.5rem)] sm:h-[calc(100svh-5rem)] mt-[4.5rem] sm:rounded-lg bg-white dark:bg-gray-800 shadow" data-controller="scroll">
  <!-- Cabeçalho do Chat -->
  <div class="text-center pt-4">
    <h1 class="text-2xl text-gray-800 dark:text-white">
      Código do chat: <%= @room.name %>
    </h1>
  </div>
  <!-- Mensagens -->
  <div class="flex-1 overflow-y-auto p-4 space-y-4" data-scroll-target="messages">
    <%= turbo_stream_from @room %>
    <div id="messages">
      <% @messages.each do |message| %>
        <%= render partial: 'messages/message', locals: { message: message, from_stream: current_user != message.user } %>
      <% end %>
    </div>
  </div>
  <!-- Formulário de Envio -->
  <div class="px-4 pt-4 pb-2 bg-gray-100 sm:rounded-b-lg dark:bg-gray-700" data-controller="character-counter" data-character-counter-countdown-value="true">
    <%= form_with url: chat_create_path, method: :post, id: "message-form", local: true, html: { class: 'flex items-center gap-4' }, data: { controller: "clear", action: "turbo:submit-end->clear#clearInput"  } do |form| %>
      <%= form.text_field :content, placeholder: "Digite sua mensagem...",
                          autocomplete: "off", id: "message-input",
                          class: "flex-1 px-4 py-3 border border-gray-300 dark:border-none rounded-lg shadow-sm bg-white
                          text-black placeholder-gray-500 focus:outline-none focus:ring focus:border-blue-500 resize-none
                          dark:bg-gray-600 dark:text-white dark:placeholder-gray-400 w-full",
                          data: { character_counter_target: "input" },  maxlength: "1024"
      %>
      <button
        type="submit"
        class="w-12 h-12 flex items-center justify-center bg-blue-700 hover:bg-blue-800 text-white rounded-full shadow-md
        focus:outline-none focus:ring-4 focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700
      dark:focus:ring-blue-800"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5">
          <path d="M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z"/>
        </svg>
      </button>
    <% end %>
    <p class="text-sm text-gray-600 dark:text-gray-300 mt-2">
      Caracteres restantes:
      <strong data-character-counter-target="counter"></strong>
    </p>
  </div>
</div>
